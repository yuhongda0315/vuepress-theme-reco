<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>融云开发者文档</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.3.1">
    <link rel="icon" href="https://docs.rongcloud.cn/assets/images/favicon.png">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
  <script src="//cdn.ronghub.com/rongcloud-feedback.1.0.0.js"></script>
  <script src="//cdn.ronghub.com/docs-feedback-inject.1.0.0.js"></script>
  <link rel="stylesheet" href="//cdn.ronghub.com/rongcloud-feedback.css">
    
    <link rel="preload" href="/assets/css/0.styles.760ae6fd.css" as="style"><link rel="preload" href="/assets/js/app.cae46f22.js" as="script"><link rel="preload" href="/assets/js/5.6fc0b16d.js" as="script"><link rel="preload" href="/assets/js/1.5098872a.js" as="script"><link rel="preload" href="/assets/js/50.86b071e3.js" as="script"><link rel="prefetch" href="/assets/js/10.c80ecd69.js"><link rel="prefetch" href="/assets/js/11.bbff6faf.js"><link rel="prefetch" href="/assets/js/12.99ea6338.js"><link rel="prefetch" href="/assets/js/13.ecce771d.js"><link rel="prefetch" href="/assets/js/14.0c5179c6.js"><link rel="prefetch" href="/assets/js/15.c9fc716d.js"><link rel="prefetch" href="/assets/js/16.18110919.js"><link rel="prefetch" href="/assets/js/17.dbf91157.js"><link rel="prefetch" href="/assets/js/18.bd3ed26d.js"><link rel="prefetch" href="/assets/js/19.b810bc65.js"><link rel="prefetch" href="/assets/js/2.c1089dca.js"><link rel="prefetch" href="/assets/js/20.5d8e8cf3.js"><link rel="prefetch" href="/assets/js/21.44b474b4.js"><link rel="prefetch" href="/assets/js/22.285369b2.js"><link rel="prefetch" href="/assets/js/23.e9bbdbb4.js"><link rel="prefetch" href="/assets/js/24.a1c24aa8.js"><link rel="prefetch" href="/assets/js/25.8b079d71.js"><link rel="prefetch" href="/assets/js/26.491577e7.js"><link rel="prefetch" href="/assets/js/27.60270f76.js"><link rel="prefetch" href="/assets/js/28.f9f966f9.js"><link rel="prefetch" href="/assets/js/29.3c0a1ba7.js"><link rel="prefetch" href="/assets/js/30.94c02916.js"><link rel="prefetch" href="/assets/js/31.67363754.js"><link rel="prefetch" href="/assets/js/32.61e0ed02.js"><link rel="prefetch" href="/assets/js/33.166ba7ac.js"><link rel="prefetch" href="/assets/js/34.0b252d02.js"><link rel="prefetch" href="/assets/js/35.6d03f26f.js"><link rel="prefetch" href="/assets/js/36.17b5edd2.js"><link rel="prefetch" href="/assets/js/37.861b462e.js"><link rel="prefetch" href="/assets/js/38.abc03cb0.js"><link rel="prefetch" href="/assets/js/39.d2499f58.js"><link rel="prefetch" href="/assets/js/4.9973c474.js"><link rel="prefetch" href="/assets/js/40.dda59fa9.js"><link rel="prefetch" href="/assets/js/41.a0be32e8.js"><link rel="prefetch" href="/assets/js/42.c5590f7f.js"><link rel="prefetch" href="/assets/js/43.17972f1a.js"><link rel="prefetch" href="/assets/js/44.09a43809.js"><link rel="prefetch" href="/assets/js/45.8c9d89e7.js"><link rel="prefetch" href="/assets/js/46.b0568027.js"><link rel="prefetch" href="/assets/js/47.4a2d9f2e.js"><link rel="prefetch" href="/assets/js/48.ee137363.js"><link rel="prefetch" href="/assets/js/49.caf9976b.js"><link rel="prefetch" href="/assets/js/51.f86c5317.js"><link rel="prefetch" href="/assets/js/52.a8213a69.js"><link rel="prefetch" href="/assets/js/53.c5e97ac3.js"><link rel="prefetch" href="/assets/js/54.4ec44659.js"><link rel="prefetch" href="/assets/js/55.c8f9006d.js"><link rel="prefetch" href="/assets/js/56.babca4e7.js"><link rel="prefetch" href="/assets/js/57.c6e643fc.js"><link rel="prefetch" href="/assets/js/58.a4c174da.js"><link rel="prefetch" href="/assets/js/59.dd1227e5.js"><link rel="prefetch" href="/assets/js/6.e4151721.js"><link rel="prefetch" href="/assets/js/60.5a8c809e.js"><link rel="prefetch" href="/assets/js/61.be69d162.js"><link rel="prefetch" href="/assets/js/62.67a778e9.js"><link rel="prefetch" href="/assets/js/63.387532a8.js"><link rel="prefetch" href="/assets/js/64.533cf8b0.js"><link rel="prefetch" href="/assets/js/65.9c5574a4.js"><link rel="prefetch" href="/assets/js/66.087b8b9b.js"><link rel="prefetch" href="/assets/js/67.52c54af2.js"><link rel="prefetch" href="/assets/js/68.df8e5648.js"><link rel="prefetch" href="/assets/js/69.1642b2cc.js"><link rel="prefetch" href="/assets/js/7.8270a0a9.js"><link rel="prefetch" href="/assets/js/70.8b130349.js"><link rel="prefetch" href="/assets/js/71.9d9973c1.js"><link rel="prefetch" href="/assets/js/8.2c306c03.js"><link rel="prefetch" href="/assets/js/9.61a4fa3c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.760ae6fd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="rong-outer"><div class="theme-container rong-box" data-v-23b0086b><div data-v-23b0086b><div data-v-23b0086b data-v-23b0086b><header class="navbar rong-nav" data-v-23b0086b><div class="rong-nav-box"><a href="https://www.rongcloud.cn/" target="_blank"><img src="https://www.rongcloud.cn/pc/images/logo.png" alt class="rong-nav-logo"></a> <a href="/" class="rong-nav-title rong-small-screen-nav-title">
      文档首页
    </a> <a href="/" class="rong-nav-title">
      文档首页
    </a><a href="/views/im/noui/guide/private/message/web.html" class="rong-nav-title">
      即时通讯
    </a><a href="/views/im/noui/guide/private/message/web.html" class="rong-nav-title">
      运营服务
    </a><a href="/views/im/noui/guide/private/message/web.html" class="rong-nav-title">
      音视频
    </a> <div class="search-box" data-v-c54ea27a><i class="iconfont reco-search" data-v-c54ea27a></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value="" data-v-c54ea27a> <!----></div> <a href="" class="rong-nav-subtitle">
      SDK 下载
    </a><a href="" class="rong-nav-subtitle">
      工单
    </a><a href="" class="rong-nav-subtitle">
      登录
    </a></div> <div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div></header> <div class="sidebar-mask" data-v-23b0086b></div> <div class="rong-content-box" data-v-23b0086b><div class="rong-sidebar-box" data-v-23b0086b><div class="rong-sidebar-all"><div class="rong-sidebar-all-title">
      全部文档
      <div class="rong-sidebar-all-content-placeholder"></div> <div class="rong-sidebar-all-content"> <div class="rong-sidebar-summary rong-sidebar-other-summary"></div></div> <!----></div></div> <aside class="sidebar rong-sidebar"><!---->  <ul class="sidebar-links rong-sidebar-links"><li><section class="sidebar-group rong-sidebar-group collapsable depth-0"><p class="sidebar-heading rong-sidebar-heading"><span>快速集成指南</span> <span class="arrow rong-sidebar-arrow right"></span></p> <!----></section></li><li><section class="sidebar-group rong-sidebar-group collapsable depth-0"><p class="sidebar-heading rong-sidebar-heading open"><span>单聊会话集成</span> <span class="arrow rong-sidebar-arrow down"></span></p> <ul class="sidebar-links rong-sidebar-links sidebar-group-items"><li><section class="sidebar-group rong-sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading rong-sidebar-heading"><span>用户管理</span> <span class="arrow rong-sidebar-arrow right"></span></p> <!----></section></li><li><section class="sidebar-group rong-sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading rong-sidebar-heading open"><span>消息管理</span> <span class="arrow rong-sidebar-arrow down"></span></p> <ul class="sidebar-links rong-sidebar-links sidebar-group-items"><li><a href="/views/im/noui/guide/private/message/ios.html" class="active sidebar-link">消息发送</a></li></ul></section></li><li><section class="sidebar-group rong-sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading rong-sidebar-heading"><span>消息管理</span> <span class="arrow rong-sidebar-arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group rong-sidebar-group collapsable depth-0"><p class="sidebar-heading rong-sidebar-heading"><span>API 接口文档</span> <span class="arrow rong-sidebar-arrow right"></span></p> <!----></section></li></ul> </aside></div> <div class="rong-page-content" data-v-23b0086b><main class="page rong-page"><div><ul class="header-navs"><li class="header-nav is-active"><a class="iconfont">单聊会话集成</a></li></ul> <div class="page-title"><p class="page-title-content">单聊会话集成
          <!----></p></div> <div class="rong-category-box rong-category-padding"><div class="rong-category-titles"><a class="rong-category-title">
            客户端
          </a><a class="rong-category-title">
            服务端
          </a></div> <div class="rong-category-titles"><!----><!----></div></div> <div class="rong-page-box content__default"><nav class="table-of-contents"><ul><li><a href="# RTC-Media-Gateway"> RTC-Media-Gateway</a><ul><li><a href="# 业务流程"> 业务流程</a></li><li><a href="# API"> API</a><ul><li><a href="# 通用"> 通用</a></li></ul></li></ul></li><li><a href="# 服务状态接口"> 服务状态接口</a></li><li><a href="# 微信小程序"> 微信小程序</a><ul><li><a href="# 客户端资源协商"> 客户端资源协商</a></li><li><a href="# 客户端退出"> 客户端退出</a></li></ul></li><li><a href="# RTMP Gateway 接口"> RTMP Gateway 接口</a><ul><li><a href="# 发布或更新 rtmp"> 发布或更新 rtmp</a></li><li><a href="# rtmp 退出"> rtmp 退出</a></li></ul></li></ul></nav><h4 id="rtc-media-gateway"><a href="#rtc-media-gateway" class="header-anchor">#</a> RTC-Media-Gateway</h4> <p>各种协商网关</p> <ul><li>微信小程序</li></ul> <h5 id="业务流程"><a href="#业务流程" class="header-anchor">#</a> 业务流程</h5> <canvas width="800" sequenced="">
  Wechat-Client -&gt; Media-Gateway: /wechat/exchange
  Media-Gateway -&gt; RTMP-Server: genereate rtmpUri
  RTMP-Server -&gt; Media-Gateway: rtmpUri
  Media-Gateway -&gt; Stream-Server: /rtmp/exchange
  Stream-Server -&gt; Media-Server: /exchange
  Media-Server -&gt; Stream-Server: get publish uris, sub uris
  Stream-Server &lt;-&gt; RTMP-Server: rtmp2rtc
  Stream-Server &lt;-&gt; RTMP-Server: rtc2rtmp
  Stream-Server -&gt; Media-Gateway: exchange response
  Media-Gateway -&gt; Wechat-Client: exchange repsonse
</canvas> <h5 id="api"><a href="#api" class="header-anchor">#</a> API</h5> <h6 id="通用"><a href="#通用" class="header-anchor">#</a> 通用</h6> <h4 id="服务状态接口"><a href="#服务状态接口" class="header-anchor">#</a> 服务状态接口</h4> <p>主要用于监控服务状态。</p> <ul><li><p>Method: <code>HTTP GET</code></p></li> <li><p>URL: <code>/monitor/state</code></p></li> <li><p>Content-Type: <code>json</code></p></li> <li><p>Request Header</p></li></ul> <p>无</p> <ul><li><p>Request Body</p></li> <li><p>示例</p></li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;resultCode&quot;</span><span class="token operator">:</span> <span class="token number">10000</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="微信小程序"><a href="#微信小程序" class="header-anchor">#</a> 微信小程序</h4> <h5 id="客户端资源协商"><a href="#客户端资源协商" class="header-anchor">#</a> 客户端资源协商</h5> <p>订阅、发布、变更资源，均可以使用此接口。</p> <ul><li><p>Method: <code>HTTP POST</code></p></li> <li><p>URL: <code>/wechat/exchange</code></p></li> <li><p>Content-Type: <code>json</code></p></li> <li><p>Request Header</p></li></ul> <table><thead><tr><th>字段</th> <th>类型</th> <th>值</th> <th>备注</th></tr></thead> <tbody><tr><td>Client-Version</td> <td>string</td> <td>sdk版本号</td> <td>接口版本号，要求填写真实sdk版本号，越详细越好</td></tr> <tr><td>Client-Type</td> <td>string</td> <td>WeChat-MiniProgram</td> <td>xiaomi、华为、iphone8、windows2010</td></tr> <tr><td>Token</td> <td>string</td> <td>VoIP Token</td> <td>用于鉴权，其中也携带了 App 或房间的相关配置</td></tr> <tr><td>Room-Id</td> <td>string</td> <td>房间 ID</td> <td></td></tr> <tr><td>App-Key</td> <td>string</td> <td>开发者的Key</td> <td></td></tr></tbody></table> <ul><li>Request Body</li></ul> <table><thead><tr><th>字段</th> <th>类型</th> <th>值</th> <th>备注</th></tr></thead> <tbody><tr><td>rtmp</td> <td>dict</td> <td>客户端要发送本地流的 rtmp 信息</td> <td></td></tr> <tr><td>rtmp.audio</td> <td>bool</td> <td>true/false</td> <td>是否发送音频</td></tr> <tr><td>rtmp.video</td> <td>bool</td> <td>true/false</td> <td>是否发送视频</td></tr> <tr><td>rtmp.resolution</td> <td>string</td> <td>0X0</td> <td>视频分辨率</td></tr> <tr><td>subscribeList</td> <td>list</td> <td>订阅列表，与普通 RTC 格式完全一致</td> <td></td></tr> <tr><td>subscribeList..uri</td> <td>string</td> <td>资源 URI</td> <td></td></tr> <tr><td>subscribeList..simulcast</td> <td>int</td> <td>资源订阅大流或小流(1: 大流，2: 小流，为空</td> <td></td></tr> <tr><td>默认小流)</td> <td></td> <td></td> <td></td></tr> <tr><td>rtmpSubscribeList</td> <td>list</td> <td>订阅 rtmp 列表，用于计费</td> <td></td></tr> <tr><td>rtmpSubscribeList..userId</td> <td>string</td> <td>要拉取的 rtmp 用户的 userId，用于计费</td> <td></td></tr> <tr><td>rtmpSubscribeList..rtmpUri</td> <td>string</td> <td>要拉取的用户的 rtmp URI，用于计费</td> <td></td></tr></tbody></table> <p>示例:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;rtmp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;audio&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">&quot;video&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">&quot;resolution&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0X0&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;subscribeList&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span><span class="token property">&quot;uri&quot;</span><span class="token operator">:</span><span class="token string">&quot;xxx1&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token property">&quot;uri&quot;</span><span class="token operator">:</span><span class="token string">&quot;xxx2&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;simulcast&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;rtmpSubscribeList&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span><span class="token property">&quot;userId&quot;</span><span class="token operator">:</span><span class="token string">&quot;userId&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;rtmpUri&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;rtmp://XXXXX&quot;</span><span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li>Response</li></ul> <table><thead><tr><th>字段</th> <th>类型</th> <th>值</th> <th>备注</th></tr></thead> <tbody><tr><td>resultCode</td> <td>int</td> <td>错误码</td> <td>10000 为成功</td></tr> <tr><td>message</td> <td>string</td> <td>错误原因</td> <td>若请求成功，则为空</td></tr> <tr><td>sdp</td> <td>json</td> <td>sdp信息</td> <td></td></tr> <tr><td>publishList</td> <td>array</td> <td>发布的 rtmp 对应的 webrtc URL，用于扩散</td> <td></td></tr> <tr><td>rtmpPublishList</td> <td>array</td> <td>用于推送的 rtmp 地址，可以用于扩散</td> <td></td></tr> <tr><td>rtmpPublishList..rtmpUri</td> <td>string</td> <td>用于推送的 rtmp 地址，可以用于扩散</td> <td></td></tr> <tr><td>clusterId</td> <td>string</td> <td>数据中心域名</td> <td>防止数据中心漂移,后续请求采用该地址;如果前面带http:// 标示服务器不支持https</td></tr></tbody></table> <p>正常示例:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;resultCode&quot;</span><span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
    <span class="token property">&quot;publishList&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span> <span class="token comment">//发布的资源</span>
        <span class="token punctuation">{</span><span class="token property">&quot;msid&quot;</span><span class="token operator">:</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;mediaType&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token property">&quot;uri&quot;</span><span class="token operator">:</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token property">&quot;msid&quot;</span><span class="token operator">:</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;mediaType&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;uri&quot;</span><span class="token operator">:</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;rtmpPublishList&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span><span class="token property">&quot;rtmpUri&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;rtmp://XXXXX&quot;</span><span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>异常示例:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;resultCode&quot;</span><span class="token operator">:</span> <span class="token number">41002</span><span class="token punctuation">,</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http server hasn't the processor&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="客户端退出"><a href="#客户端退出" class="header-anchor">#</a> 客户端退出</h5> <ul><li><p>Method: <code>HTTP POST</code></p></li> <li><p>URL: <code>/wechat/exit</code></p></li> <li><p>Content-Type: <code>json</code></p></li> <li><p>Request Header</p></li></ul> <table><thead><tr><th>字段</th> <th>类型</th> <th>值</th> <th>备注</th></tr></thead> <tbody><tr><td>Client-Version</td> <td>string</td> <td>sdk版本号</td> <td>接口版本号，要求填写真实sdk版本号，越详细越好</td></tr> <tr><td>Client-Type</td> <td>string</td> <td>WeChat-MiniProgram</td> <td>xiaomi、华为、iphone8、windows2010</td></tr> <tr><td>Token</td> <td>string</td> <td>VoIP Token</td> <td>用于鉴权，其中也携带了 App 或房间的相关配置</td></tr> <tr><td>Room-Id</td> <td>string</td> <td>房间 ID</td> <td></td></tr> <tr><td>App-Key</td> <td>string</td> <td>开发者的Key</td> <td></td></tr></tbody></table> <ul><li>Request Body</li></ul> <p>无</p> <ul><li>Response</li></ul> <table><thead><tr><th>字段</th> <th>类型</th> <th>值</th> <th>备注</th></tr></thead> <tbody><tr><td>resultCode</td> <td>int</td> <td>错误码</td> <td>10000 为成功</td></tr> <tr><td>message</td> <td>string</td> <td>错误原因</td> <td>若请求成功，则为空</td></tr></tbody></table> <ul><li>正常示例</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;resultCode&quot;</span><span class="token operator">:</span> <span class="token number">10000</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>异常示例</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;resultCode&quot;</span><span class="token operator">:</span> <span class="token number">41002</span><span class="token punctuation">,</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http server hasn't the processor&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="rtmp-gateway-接口"><a href="#rtmp-gateway-接口" class="header-anchor">#</a> RTMP Gateway 接口</h3> <h4 id="发布或更新-rtmp"><a href="#发布或更新-rtmp" class="header-anchor">#</a> 发布或更新 rtmp</h4> <ul><li><p>Method: <code>HTTP POST</code></p></li> <li><p>URL: <code>/rtmp/exchange</code></p></li> <li><p>Content-Type: <code>json</code></p></li> <li><p>Request Header</p></li></ul> <table><thead><tr><th>字段</th> <th>类型</th> <th>值</th> <th>备注</th></tr></thead> <tbody><tr><td>clientVersion</td> <td>string</td> <td>sdk版本号</td> <td>接口版本号，要求填写真实sdk版本号，越详细越好</td></tr> <tr><td>clientType</td> <td>string</td> <td>WeChat-MiniProgram</td> <td>xiaomi、华为、iphone8、windows2010</td></tr> <tr><td>Token</td> <td>string</td> <td>VoIP Token</td> <td>用于鉴权，其中也携带了 App 或房间的相关配置</td></tr> <tr><td>RoomId</td> <td>string</td> <td>房间 ID</td> <td></td></tr> <tr><td>RoomType</td> <td>int</td> <td>房间类型(普通音视频/直播)</td> <td></td></tr> <tr><td>App-Key</td> <td>string</td> <td>开发者的Key</td> <td></td></tr></tbody></table> <blockquote><p>Header 部分可以直接 copy 作为与 MediaServer <code>exchange</code> 使用。</p></blockquote> <ul><li>Request Body</li></ul> <table><thead><tr><th>字段</th> <th>类型</th> <th>值</th> <th>备注</th></tr></thead> <tbody><tr><td>rtmp</td> <td>dict</td> <td>客户端要发送本地流的 rtmp 信息</td> <td></td></tr> <tr><td>rtmp.audio</td> <td>bool</td> <td>true/false</td> <td>是否发送音频</td></tr> <tr><td>rtmp.video</td> <td>bool</td> <td>true/false</td> <td>是否发送视频</td></tr> <tr><td>rtmp.resolution</td> <td>string</td> <td>0X0</td> <td>视频分辨率</td></tr> <tr><td>rtmp.uri</td> <td>string</td> <td>拉流的 rtmp uri</td> <td></td></tr> <tr><td>rtmp.timestamp</td> <td>long</td> <td>发布资源的时间戳</td> <td>如果时间戳变更，则表明 uri 或资源类型变更，需要重新拉取和发布。小于当前的时间戳可以忽略</td></tr> <tr><td>rtmp.rtmpSubscribeList..userId</td> <td>string</td> <td>rtc2rtmp 的用户 Id</td> <td></td></tr> <tr><td>rtmp.rtmpSubscribeList..rtmpUri</td> <td>long</td> <td>rtc2rtmp 的用户推送到的 uri</td> <td></td></tr></tbody></table> <p>| rtc.subscribeList | list | 订阅列表，与普通 RTC 格式完全一致 |  |
| rtc.subscribeList..uri | string | 资源 URI |  |
| rtc.subscribeList..simulcast | int | 资源订阅大流或小流(1: 大流，2: 小流，为空
默认小流) |  |
| rtc.extend | string | 传递给后端服务的扩展字段，比如录像 |  |</p> <blockquote><p>rtc 部分可以直接 copy 作为与 MediaServer <code>exchange</code>  body 使用，但是 sdp 字段徐需要转码服务生成。</p></blockquote> <ul><li>示例</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;rtmp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;audio&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">&quot;video&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">&quot;resolution&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0X0&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;uri&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rtmp://XXXXX&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token number">1586273915475</span><span class="token punctuation">,</span>
        <span class="token property">&quot;rtmpSubscribeList&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span><span class="token property">&quot;userId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;userId&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;rtmpUri&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;rtmp://XXXXX&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token property">&quot;userId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;userId&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;rtmpUri&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;rtmp://XXXXX&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;rtc&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;subscribeList&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span><span class="token property">&quot;uri&quot;</span><span class="token operator">:</span><span class="token string">&quot;xxx1&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token property">&quot;uri&quot;</span><span class="token operator">:</span><span class="token string">&quot;xxx2&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;simulcast&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token comment">//扩展配置，mediaserver不解析，透传给后端服务</span>
        <span class="token property">&quot;extend&quot;</span><span class="token operator">:</span><span class="token string">&quot;{\&quot;resolutionInfo\&quot;:\&quot;0X0\&quot;}&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><ul><li>Response</li></ul> <table><thead><tr><th>字段</th> <th>类型</th> <th>值</th> <th>备注</th></tr></thead> <tbody><tr><td>resultCode</td> <td>int</td> <td>错误码</td> <td>10000 为成功</td></tr> <tr><td>sdp</td> <td>string</td> <td>协商返回的 sdp 信息</td> <td></td></tr> <tr><td>publishList</td> <td>dict</td> <td>发布资源 uri 列表</td> <td></td></tr> <tr><td>clusterId</td> <td>string</td> <td>MediaServer 数据中心 URL</td> <td></td></tr></tbody></table> <blockquote><p>与 MediaServer 交互 <code>exchange</code> response 直接透传即可。</p></blockquote> <ul><li>正常示例</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;resultCode&quot;</span><span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
    <span class="token property">&quot;sdp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;answer&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;sdp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xxxx&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;publishList&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span> <span class="token comment">//发布的资源</span>
        <span class="token punctuation">{</span><span class="token property">&quot;msid&quot;</span><span class="token operator">:</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;mediaType&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token property">&quot;uri&quot;</span><span class="token operator">:</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token property">&quot;msid&quot;</span><span class="token operator">:</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;mediaType&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;uri&quot;</span><span class="token operator">:</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;clusterId&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://awsnx-rtc40-data-rtc40-109.rongcloud.net&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li>异常示例</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;resultCode&quot;</span><span class="token operator">:</span> <span class="token number">41002</span><span class="token punctuation">,</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http server hasn't the processor&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="rtmp-退出"><a href="#rtmp-退出" class="header-anchor">#</a> rtmp 退出</h4> <ul><li><p>Method: <code>HTTP POST</code></p></li> <li><p>URL: <code>/rtmp/exit</code></p></li> <li><p>Content-Type: <code>json</code></p></li> <li><p>Request Header</p></li></ul> <p>| clientVersion |  string | sdk版本号 | 接口版本号，要求填写真实sdk版本号，越详细越好 |
| clientType | string | WeChat-MiniProgram | xiaomi、华为、iphone8、windows2010 | 操作系统版本 |       |
| Token | string | VoIP Token | 用于鉴权，其中也携带了 App 或房间的相关配置 |
| RoomId | string | 房间 ID |       |
| RoomType | int | 房间类型(普通音视频/直播) |       |
| App-Key | string | 开发者的Key |       |</p> <blockquote><p>Header 部分可以直接 copy 作为与 MediaServer <code>exit</code> 使用。</p></blockquote> <ul><li>Request Body</li></ul> <p>无</p> <ul><li>Response</li></ul> <table><thead><tr><th>字段</th> <th>类型</th> <th>值</th> <th>备注</th></tr></thead> <tbody><tr><td>resultCode</td> <td>int</td> <td>错误码</td> <td>10000 为成功</td></tr> <tr><td>message</td> <td>string</td> <td>错误原因</td> <td>若请求成功，则为空</td></tr></tbody></table> <blockquote><p>与 MediaServer 交互 <code>exit</code> response 直接透传即可。</p></blockquote> <ul><li>正常示例</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;resultCode&quot;</span><span class="token operator">:</span> <span class="token number">10000</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>异常示例</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;resultCode&quot;</span><span class="token operator">:</span> <span class="token number">41002</span><span class="token punctuation">,</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http server hasn't the processor&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div> <div class="rong-like"><p class="rong-like-title">文档是否解决您的问题 ?</p> <div class="rong-like-btn-box"><a class="rong-like-btn"></a> <a class="rong-dislike-btn"></a></div> <!----> <div class="rong-like-other"><p>如果遇到产品相关问题，您可 <a href="https://www.baidu.com">提交工单</a> 寻求帮助</p></div></div> <!----> <!----></div></main></div></div></div></div></div> <!----></div><div class="global-ui"><div class="back-to-ceiling" style="right:12rem;bottom:4rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-a81d141e data-v-a81d141e><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-a81d141e><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-a81d141e></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-a81d141e></path></svg></div></div></div>
    <script src="/assets/js/app.cae46f22.js" defer></script><script src="/assets/js/5.6fc0b16d.js" defer></script><script src="/assets/js/1.5098872a.js" defer></script><script src="/assets/js/50.86b071e3.js" defer></script>
  </body>
</html>
